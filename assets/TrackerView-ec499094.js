import{a as L,u as x}from"./options-ff2417ee.js";import{G as M,O as C,S as y,W as v,V as k,u as E,C as b,L as S,M as z,d as B,a as P}from"./renderer-59f25026.js";import{d as w,_ as T,o as _,c as D,a as O,b as $,u as c}from"./index-f5a9788a.js";let u,p,i=[],d=[],f=new M,r=new C,m=new y,l=new v,h=new Array,g;const N=w({data(){return{pointer:new k(-100,-100),inTransition:!1,transitionIteration:0,transitionLength:100,stopAnimate:!1}},props:{linesCount:Number,pointsCount:Number,lineColor:String,backgroundColor:String},methods:{getData(){return!this.linesCount||!this.pointsCount?[[]]:L(this.linesCount,this.pointsCount)},onWindowResize(){let t=this.$refs.canvas.parentElement;t&&(r.updateProjectionMatrix(),l.setSize(t.clientWidth,t.clientHeight-6))},animateBuzz(){if(!this.linesCount||!this.pointsCount)return;const t=Math.round(this.pointer.x),o=Math.round(this.pointer.y);if(this.inTransition){this.transitionIteration++;for(let n=0;n<this.linesCount;n++)for(let e=0;e<this.pointsCount;e++)if(o-7<n&&o+7>n&&t-7<e&&t+7>e){if(Math.sqrt(Math.pow(t-e,2)+Math.pow(o-n,2))>7){i[n][e]+=h[n][e];continue}const a=i[n][e];i[n][e]=a<40?a+40/20:40,h[n][e]=(d[n][e]-i[n][e])/this.transitionLength}else i[n][e]+=h[n][e]}else{let n=i;d=this.getData();for(let e=0;e<this.linesCount;e++)for(let s=0;s<this.pointsCount;s++){let a=d[e][s]-n[e][s];h[e][s]=a/this.transitionLength}this.transitionIteration=0,this.inTransition=!0}},animateWave(){if(!(!this.linesCount||!this.pointsCount))for(let t=0;t<this.linesCount;t++)i[t].push(...i[t].splice(0,1))},animate(){this.stopAnimate||(requestAnimationFrame(this.animate),this.transitionIteration>this.transitionLength&&(this.inTransition=!1),this.animateBuzz(),this.render())},render(){E(g[0],g[1],i),l.render(m,r)},updateMousePos(t){var n=this.$refs.canvas.getBoundingClientRect();let e,s;if(t instanceof TouchEvent){t.preventDefault();var a=t.touches[0]||t.changedTouches[0];e=a.pageX,s=a.pageY}else e=t.clientX,s=t.clientY;this.pointer.x=e-n.left,this.pointer.y=s-n.top,this.pointer.x=this.pointer.x<0?0:this.pointer.x,this.pointer.y=this.pointer.y<0?0:this.pointer.y,this.pointer.x=this.pointer.x/n.width*r.right,this.pointer.y=(n.height-this.pointer.y)/n.height*r.top},removeSelection(t){this.pointer.x=-100,this.pointer.y=-100}},mounted(){i=this.getData(),h=JSON.parse(JSON.stringify(i)),r=new C(0,i[0].length-1,i.length-1,0),r.position.z=1e3;const t=this.$refs.canvas;l=new v({antialias:!0,canvas:t}),l.setPixelRatio(window.devicePixelRatio),l.useLegacyLights=!1,m.add(f),m.background=new b(this.backgroundColor),u=new S({color:this.lineColor}),p=new z({color:this.backgroundColor}),window.addEventListener("resize",this.onWindowResize),t.addEventListener("mousemove",this.updateMousePos),t.addEventListener("touchmove",this.updateMousePos),t.addEventListener("touchstart",this.updateMousePos),t.addEventListener("touchcancel",this.updateMousePos),t.addEventListener("touchend",this.removeSelection),t.addEventListener("click",this.removeSelection),g=B(f,i,u,p),this.onWindowResize(),this.animate()},unmounted(){this.stopAnimate=!0,u.dispose(),p.dispose(),P(f)}}),R={class:"flex-grow-1 p-0 m-0"},W={ref:"canvas"};function A(t,o,n,e,s,a){return _(),D("div",R,[O("canvas",W,null,512)])}const G=T(N,[["render",A]]),X=w({__name:"TrackerView",setup(t){const o=x();return(n,e)=>(_(),$(G,{"lines-count":c(o).numOfLines,"points-count":c(o).numOfPoints,"background-color":c(o).backgroundColor,"line-color":c(o).lineColor},null,8,["lines-count","points-count","background-color","line-color"]))}});export{X as default};
