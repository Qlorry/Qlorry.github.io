import{a as x}from"./generator-b8d5f5e7.js";import{G as y,O as m,b as L,W as v,V as _,C as E}from"./three.module-5f6cbc95.js";import{u as S,c as b,d as M}from"./shader-renderer-c332ea35.js";import{d as C,_ as T,o as w,c as z,a as r,t as f,F as D,b as $}from"./index-a29d12ae.js";let o=[],l=[],p=new y,h=new m,d=new L,u=new v,c=new Array,g;const k=C({data(){return{pointer:new _,linesCount:1,pointsCount:20,maxHeight:30,inTransition:!1,transitionIteration:0,transitionLength:70,stopAnimate:!1,changeShape:!1,backgroundColor:"#ff0000",lineColor:"#00ff00"}},methods:{getData(){return!this.linesCount||!this.pointsCount?[[]]:x(this.linesCount,this.pointsCount)},onWindowResize(){let t=this.$refs.canvas.parentElement;t&&(h.updateProjectionMatrix(),u.setSize(t.clientWidth,t.clientHeight-6))},animateBuzz(){if(!this.linesCount||!this.pointsCount)return;const t=Math.round(this.pointer.x),n=Math.round(this.pointer.y);if(this.inTransition){this.transitionIteration++;for(let e=0;e<this.linesCount;e++)for(let i=0;i<this.pointsCount;i++){if(Math.sqrt(Math.pow(t-i,2)+Math.pow(n-e,2))>7){o[e][i]+=c[e][i];continue}const a=o[e][i];o[e][i]=a<40?a+40/20:40,c[e][i]=(l[e][i]-o[e][i])/this.transitionLength}}else{let e=o;l=this.getData();for(let i=0;i<this.linesCount;i++)for(let s=0;s<this.pointsCount;s++){let a=l[i][s]-e[i][s];c[i][s]=a/this.transitionLength}this.transitionIteration=0,this.inTransition=!0}},animate(){if(!this.stopAnimate){if(requestAnimationFrame(this.animate),this.transitionIteration>this.transitionLength&&(this.inTransition=!1),this.inTransition?this.transitionIteration++:(this.transitionIteration=0,this.inTransition=!0),this.changeShape){debugger;this.animateBuzz(),S(g,o),this.changeShape=!1}this.render()}},render(){u.render(d,h)},updateMousePos(t){var e=this.$refs.canvas.getBoundingClientRect();let i,s;if(t instanceof TouchEvent){t.preventDefault();var a=t.touches[0]||t.changedTouches[0];i=a.pageX,s=a.pageY}else i=t.clientX,s=t.clientY;this.pointer.x=i-e.left,this.pointer.y=s-e.top,this.pointer.x=this.pointer.x<0?0:this.pointer.x,this.pointer.y=this.pointer.y<0?0:this.pointer.y,this.pointer.x=this.pointer.x/e.width*h.right,this.pointer.y=(e.height-this.pointer.y)/e.height*h.top},removeSelection(t){this.pointer.x=-100,this.pointer.y=-100}},mounted(){debugger;l=this.getData(),o=this.getData(),c=JSON.parse(JSON.stringify(o));for(let n=0;n<this.linesCount;n++)for(let e=0;e<this.pointsCount;e++){let i=l[n][e]-o[n][e];c[n][e]=i/this.transitionLength}h=new m(-5,30,5,-5),h.position.z=2e3;const t=this.$refs.canvas;u=new v({antialias:!0,canvas:t}),u.setPixelRatio(window.devicePixelRatio),u.useLegacyLights=!1,d.add(p),d.background=new E("#242424"),window.addEventListener("resize",this.onWindowResize),t.addEventListener("mousemove",this.updateMousePos),t.addEventListener("touchmove",this.updateMousePos),t.addEventListener("touchstart",this.updateMousePos),t.addEventListener("touchcancel",this.updateMousePos),t.addEventListener("touchend",this.removeSelection),t.addEventListener("click",this.removeSelection),g=b(p,o,this.lineColor??"",this.backgroundColor??""),this.onWindowResize(),this.animate()},unmounted(){this.stopAnimate=!0,M(p)}}),P={class:"d-flex flex-row p-2 justify-content-evenly"},B={class:"flex-grow-1 p-0 m-0"},R={ref:"canvas"};function I(t,n,e,i,s,a){return w(),z(D,null,[r("div",P,[r("h4",null,f(t.pointer.x),1),r("h4",null,f(t.pointer.y),1),r("button",{type:"button",class:"btn btn-danger",onClick:n[0]||(n[0]=j=>t.changeShape=!t.changeShape)},"Change")]),r("div",B,[r("canvas",R,null,512)])],64)}const W=T(k,[["render",I]]),V=C({__name:"TestView",setup(t){return(n,e)=>(w(),$(W))}});export{V as default};
